\documentclass[12pt]{article}

\usepackage{amssymb,amsmath,amsthm}
\usepackage[top=1in, bottom=1in, left=1.25in, right=1.25in]{geometry}
\usepackage{fancyhdr}
\usepackage{enumerate}
\usepackage[bw,framed,numbered]{mcode}
\usepackage{graphicx}

% Comment the following line to use TeX's default font of Computer Modern.
\usepackage{times,txfonts}

\newtheoremstyle{homework}% name of the style to be used
  {18pt}% measure of space to leave above the theorem. E.g.: 3pt
  {12pt}% measure of space to leave below the theorem. E.g.: 3pt
  {}% name of font to use in the body of the theorem
  {}% measure of space to indent
  {\bfseries}% name of head font
  {:}% punctuation between head and body
  {2ex}% space after theorem head; " " = normal interword space
  {}% Manually specify head
\theoremstyle{homework} 

% Set up an Exercise environment and a Solution label.
\newtheorem*{exercisecore}{Exercise \@currentlabel}
\newenvironment{exercise}[1]
{\def\@currentlabel{#1}\exercisecore}
{\endexercisecore}

\newcommand{\localhead}[1]{\par\smallskip\noindent\textbf{#1}\nobreak\\}%
\newcommand\solution{\localhead{Solution:}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Stuff for getting the name/document date/title across the header
\makeatletter
\RequirePackage{fancyhdr}
\pagestyle{fancy}
\fancyfoot[C]{\ifnum \value{page} > 1\relax\thepage\fi}
\fancyhead[L]{\ifx\@doclabel\@empty\else\@doclabel\fi}
\fancyhead[C]{\ifx\@docdate\@empty\else\@docdate\fi}
\fancyhead[R]{\ifx\@docauthor\@empty\else\@docauthor\fi}
\headheight 15pt

\def\doclabel#1{\gdef\@doclabel{#1}}
\doclabel{Use {\tt\textbackslash doclabel\{MY LABEL\}}.}
\def\docdate#1{\gdef\@docdate{#1}}
\docdate{Use {\tt\textbackslash docdate\{MY DATE\}}.}
\def\docauthor#1{\gdef\@docauthor{#1}}
\docauthor{Use {\tt\textbackslash docauthor\{MY NAME\}}.}
\makeatother

% Shortcuts for blackboard bold number sets (reals, integers, etc.)
\newcommand{\Reals}{\ensuremath{\mathbb R}}
\newcommand{\Nats}{\ensuremath{\mathbb N}}
\newcommand{\Ints}{\ensuremath{\mathbb Z}}
\newcommand{\Rats}{\ensuremath{\mathbb Q}}
\newcommand{\Cplx}{\ensuremath{\mathbb C}}
%% Some equivalents that some people may prefer.
\let\RR\Reals
\let\NN\Nats
\let\II\Ints
\let\CC\Cplx

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% The main document start here.

% The following commands set up the material that appears in the header.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% The main document start here.

% The following commands set up the material that appears in the header.
\doclabel{Math 310: Homework 6}
\docauthor{Parker Whaley}
\docdate{September 9, 2016}

\newcommand{\vv}{\mathbf{v}}
\begin{document}
\begin{exercise}

Use the worksheet to wite down the $PLU$ factorization.
\end{exercise}
$$P_1=\begin{bmatrix}
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 1
\end{bmatrix},
L_1=\begin{bmatrix}
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 1
\end{bmatrix},
U_1=\begin{bmatrix}
1/3 & 0 & 0\\
1 & 1 & 1\\
1/2 & 0 & 1
\end{bmatrix}$$

$$P_2=\begin{bmatrix}
0 & 1 & 0\\
1 & 0 & 0\\
0 & 0 & 1
\end{bmatrix},
L_2=\begin{bmatrix}
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 1
\end{bmatrix},
U_2=\begin{bmatrix}
1 & 1 & 1\\
1/3 & 0 & 0\\
1/2 & 0 & 1
\end{bmatrix}$$

$$P_3=\begin{bmatrix}
0 & 1 & 0\\
1 & 0 & 0\\
0 & 0 & 1
\end{bmatrix},
L_3=\begin{bmatrix}
1 & 0 & 0\\
1/3 & 1 & 0\\
1/2 & 0 & 1
\end{bmatrix},
U_3=\begin{bmatrix}
1 & 1 & 1\\
0 & -1/3 & -1/3\\
0 & -1/2 & 1/2
\end{bmatrix}$$

$$P_4=\begin{bmatrix}
0 & 1 & 0\\
0 & 0 & 1\\
1 & 0 & 0
\end{bmatrix},
L_4=\begin{bmatrix}
1 & 0 & 0\\
1/2 & 1 & 0\\
1/3 & 0 & 1
\end{bmatrix},
U_4=\begin{bmatrix}
1 & 1 & 1\\
0 & -1/2 & 1/2\\
0 & -1/3 & -1/3
\end{bmatrix}$$

$$P_5=\begin{bmatrix}
0 & 1 & 0\\
0 & 0 & 1\\
1 & 0 & 0
\end{bmatrix},
L_5=\begin{bmatrix}
1 & 0 & 0\\
1/2 & 1 & 0\\
1/3 & 2/3 & 1
\end{bmatrix},
U_5=\begin{bmatrix}
1 & 1 & 1\\
0 & -1/2 & 1/2\\
0 & 0 & -2/3
\end{bmatrix}$$

\begin{exercise}

Let $$A=\begin{bmatrix}
10^{-16} & 1\\
1 & 1
\end{bmatrix},
b=\begin{bmatrix}
2\\
3
\end{bmatrix}$$
\end{exercise}
\begin{enumerate}[(a)]
\item
Solve $Ax=b$ exactly.
$$\begin{bmatrix}
10^{-16} & 1\\
1 & 1
\end{bmatrix}x=\begin{bmatrix}
2\\
3
\end{bmatrix}$$

$$\begin{bmatrix}
10^{-16} & 1\\
0 & 1-10^{16}
\end{bmatrix}x=\begin{bmatrix}
2\\
3-2*10^{16}
\end{bmatrix}$$

$$\begin{bmatrix}
10^{-16} & 0\\
0 & 1-10^{16}
\end{bmatrix}x=\begin{bmatrix}
2-\frac{3-2*10^{16}}{1-10^{16}}\\
3-2*10^{16}
\end{bmatrix}$$

$$\begin{bmatrix}
1 & 0\\
0 & 1
\end{bmatrix}x=\begin{bmatrix}
\frac{2}{10^{-16}}-\frac{3-2*10^{16}}{10^{-16}(1-10^{16})}\\
\frac{3-2*10^{16}}{1-10^{16}}
\end{bmatrix}$$

$$x=
\begin{bmatrix}
\frac{2}{10^{-16}}-\frac{3-2*10^{16}}{10^{-16}(1-10^{16})}\\
\frac{3-2*10^{16}}{1-10^{16}}
\end{bmatrix}=
\begin{bmatrix}
\frac{2-2*10^{16}-(3-2*10^{16})}{10^{-16}(1-10^{16})}\\
\frac{3-2*10^{16}}{1-10^{16}}
\end{bmatrix}=
\begin{bmatrix}
\frac{-1}{10^{-16}-1}\\
\frac{3-2*10^{16}}{1-10^{16}}
\end{bmatrix}\approx
\begin{bmatrix}
1\\
2
\end{bmatrix}
$$
As a check:
$$Ax=\begin{bmatrix}
10^{-16} & 1\\
1 & 1
\end{bmatrix}
\begin{bmatrix}
1\\
2
\end{bmatrix}=
\begin{bmatrix}
10^{-16}+2\\
3
\end{bmatrix}\approx
\begin{bmatrix}
2\\
3
\end{bmatrix}
$$
\item
What is the 2-norm condition number for $A$?  Is A well behaved in the 2-norm?\\
The condition number is $2.6180$.  This is well conditioned since errors is output will be on the same order as errors in imput.
\item
Here is my solution to solving a matrix without pivoting
\lstinputlisting{../octave/matrixSolve.m}
And the solution I get:
\lstinputlisting{../octave/d1.txt}
The problem with this method is that adding and subtracting large numbers causes errors:
\lstinputlisting{../octave/d2.txt}
\end{enumerate}
\begin{exercise}

From the worksheet on implementing partial pivoting, show your code for mylu.m. Then
show your answer to problem 10. Also, use your function usolve from the last homework
and lsolve from the course web page to solve $Ax = b$ where $A$ is the matrix from
problem 10 of the worksheet and $b = \begin{bmatrix}-1\\ 6\\ -8\end{bmatrix}$.
\end{exercise}
\lstinputlisting{../octave/mylu.m}

\end{document}