>> a=rand(4,4)*2-1
a =

  -0.1010625   0.9362113   0.0139713   0.4418893
  -0.5953604   0.7011362  -0.4407313  -0.7969206
  -0.9817731  -0.2038775   0.2376541   0.2044053
  -0.0058744   0.1644356  -0.8053894   0.8938794

>> b=rand(4,1)
b =

   0.74662
   0.17145
   0.29130
   0.36871

>> [P,L,U]=myplu(a);
U =

  -0.1010625   0.9362113   0.0139713   0.4418893
  -0.5953604   0.7011362  -0.4407313  -0.7969206
  -0.9817731  -0.2038775   0.2376541   0.2044053
  -0.0058744   0.1644356  -0.8053894   0.8938794

U =

  -0.9817731  -0.2038775   0.2376541   0.2044053
  -0.5953604   0.7011362  -0.4407313  -0.7969206
  -0.1010625   0.9362113   0.0139713   0.4418893
  -0.0058744   0.1644356  -0.8053894   0.8938794

next
U =

  -0.98177  -0.20388   0.23765   0.20441
   0.00000   0.82477  -0.58485  -0.92087
   0.00000   0.95720  -0.01049   0.42085
   0.00000   0.16566  -0.80681   0.89266

U =

  -0.98177  -0.20388   0.23765   0.20441
   0.00000   0.95720  -0.01049   0.42085
   0.00000   0.82477  -0.58485  -0.92087
   0.00000   0.16566  -0.80681   0.89266

next
U =

  -0.98177  -0.20388   0.23765   0.20441
   0.00000   0.95720  -0.01049   0.42085
   0.00000   0.00000  -0.57581  -1.28350
   0.00000   0.00000  -0.80500   0.81982

U =

  -0.98177  -0.20388   0.23765   0.20441
   0.00000   0.95720  -0.01049   0.42085
   0.00000   0.00000  -0.80500   0.81982
   0.00000   0.00000  -0.57581  -1.28350

next
>> P
P =

Permutation Matrix

   0   0   1   0
   1   0   0   0
   0   0   0   1
   0   1   0   0

>> P*a*b-L*U*b
ans =

   0
   0
   0
   0

>> diary off
